/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */

import * as React from 'react';

import { NotificationCard } from '@business-app/fabric/lib/components/Card';

interface ExampleStates {
  thePercent: number;
}

export class NotificationCardExample extends React.Component<{}, ExampleStates> {
  constructor(props: {}) {
    super({});

    const intervalDelay = 100;
    const intervalIncrement = 0.01;

    this.state = {
      thePercent: 0
    };

    setInterval(() => {
      this.setState({ thePercent: (this.state.thePercent + intervalIncrement) % 1 }, () => {
        if (this.state.thePercent >= 1) {
          this.setState({ thePercent: 0 });
        }
      });
    }, intervalDelay);
  }

  public render() {
    const { thePercent } = this.state;

    return (
      <div style={{ paddingLeft: 24 }}>
        <NotificationCard
          notificationType={'Status'}
          isNew={true}
          iconProps={{ iconName: 'Completed', styles: { root: { color: 'rgb(16, 124, 16)' } } }}
          heading={'Information + Status'}
          subHeading={'This is a Status notification'}
          message="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce tincidunt purus ac tellus mollis, in placerat purus luctus."
          actionLinks={[{ text: 'Call to action', link: '' }]}
          hasCloseButton={true}
          onDismiss={() => {
            alert('Close requested!');
          }}
        />

        <NotificationCard
          notificationType={'Peer'}
          isNew={true}
          timestamp={'12:32 PM'}
          persona={{ imageUrl: 'https://place-hold.it/32x32/E3008C/FFFFFF/&text=AA&bold&fontsize=14' }}
          heading={'From a Peer'}
          subHeading={'This is a Peer notification'}
          message="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce tincidunt purus ac tellus mollis, in placerat purus luctus."
          actionLinks={[{ text: 'More Information', link: '' }]}
        />

        <NotificationCard
          notificationType={'Alias'}
          isNew={true}
          timestamp={'12:34 PM'}
          persona={{ imageUrl: 'https://place-hold.it/32x32/E3008C/FFFFFF/&text=AA&bold&fontsize=14' }}
          heading={'From an Alias or Group'}
          subHeading={'This is an Alias notification'}
          message="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce tincidunt purus ac tellus mollis, in placerat purus luctus."
          actionLinks={[
            { text: 'More Information', link: '' },
            { text: 'Call to Action', link: '' }
          ]}
        />

        <NotificationCard
          notificationType={'Meeting'}
          isNew={true}
          heading={'Meeting'}
          meetingTime={'9:30 AM - 10:00 AM'}
          meetingLocation={'Building 83 / 4211 and Teams'}
          hasSnoozeButton={true}
          onSnooze={() => {
            alert('Snooze for Metting');
          }}
        />

        <NotificationCard
          notificationType={'Progress'}
          isNew={true}
          heading={'Progress - Indeterminate'}
          progressStatus={'Uploading...'}
        />

        <NotificationCard
          notificationType={'Progress'}
          isNew={true}
          heading={'Progress - With Percent'}
          progressStatus={`${Math.round(this.state.thePercent * 100)}% complete`}
          percentComplete={this.state.thePercent}
        />

        <NotificationCard
          notificationType={'Progress'}
          isNew={true}
          heading={'Progress - Spinner'}
          spinner={true}
          message={`We will notify you when this is complete.`}
        />
      </div>
    );
  }
}
