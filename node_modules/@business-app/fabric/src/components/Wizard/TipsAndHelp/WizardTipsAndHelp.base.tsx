/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */

import { IconButton } from '@fluentui/react/lib/Button';
import { Icon } from '@fluentui/react/lib/Icon';
import { css } from '@fluentui/react/lib/Utilities';
import { classNamesFunction } from '@fluentui/react/lib/Utilities';
import * as React from 'react';
import {
  WizardTipsAndHelpProps,
  WizardTipsAndHelpStyleProps,
  WizardTipsAndHelpStyles
} from './WizardTipsAndHelp.types';

interface IWizardTipsAndHelpState {
  isWizardTipsAndHelpVisibleOnSmallScreens?: boolean;
}

const getClassNames = classNamesFunction<WizardTipsAndHelpStyleProps, WizardTipsAndHelpStyles>();

export class WizardTipsAndHelpBase extends React.Component<WizardTipsAndHelpProps> {
  public state: IWizardTipsAndHelpState = {
    isWizardTipsAndHelpVisibleOnSmallScreens: false
  };

  public render() {
    const { children, title, closeButtonText, theme, styles, className } = this.props;
    const classNames = getClassNames(styles, {
      theme: theme!,
      className
    });

    return (
      <>
        <IconButton
          iconProps={{ iconName: 'Help' }}
          className={classNames.show}
          onClick={this.onShowClicked}
          ariaLabel={title}
          title={title}
        />
        <aside
          className={css(
            classNames.root,
            !this.state.isWizardTipsAndHelpVisibleOnSmallScreens && classNames.rootHidden
          )}
        >
          <header className={classNames.header}>
            <Icon iconName="Help" className={classNames.icon} />
            <h4 className={classNames.title}>{title}</h4>
            <IconButton
              iconProps={{ iconName: 'Cancel' }}
              className={classNames.close}
              onClick={this.onCloseClicked}
              ariaLabel={closeButtonText}
              title={closeButtonText}
            />
          </header>
          {children}
        </aside>
      </>
    );
  }

  private onShowClicked = () => {
    this.setState({
      isWizardTipsAndHelpVisibleOnSmallScreens: true
    });
  };

  private onCloseClicked = () => {
    this.setState({
      isWizardTipsAndHelpVisibleOnSmallScreens: false
    });
  };
}
