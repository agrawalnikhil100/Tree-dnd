/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */

import { BaseComponent, classNamesFunction } from '@fluentui/react/lib/Utilities';
import * as React from 'react';
import { WizardFooter } from './Footer/WizardFooter';
import { WizardProgress } from './Progress/WizardProgress';
import { WizardProps, WizardStyleProps, WizardStyles } from './Wizard.types';

const getClassNames = classNamesFunction<WizardStyleProps, WizardStyles>();

export class WizardBase extends BaseComponent<WizardProps> {
  public render() {
    const {
      progressProps,
      footerProps,
      onRenderHeaderItems,
      onRenderHeaderFarItems,
      onRenderStep,
      onRenderRightPane,
      className,
      styles,
      theme
    } = this.props;

    const classNames = getClassNames(styles, {
      theme: theme!,
      className
    });
    const displayHeader = onRenderHeaderItems || onRenderHeaderFarItems;

    return (
      <div className={classNames.root}>
        <WizardProgress {...progressProps} />
        <div className={classNames.bodyWrapper}>
          {displayHeader && (
            <header className={classNames.header}>
              {onRenderHeaderItems && <div className={classNames.headerItems}>{onRenderHeaderItems()}</div>}
              {onRenderHeaderFarItems && (
                <div className={classNames.headerFarItems}>{onRenderHeaderFarItems()}</div>
              )}
            </header>
          )}
          <section className={classNames.section}>
            <div className={classNames.stepContainer}>
              <div className={classNames.stepBody}>{onRenderStep()}</div>
              <WizardFooter {...footerProps} />
            </div>
            {onRenderRightPane && onRenderRightPane()}
          </section>
        </div>
      </div>
    );
  }
}
